mnist <- read_mnist(
path = NULL,
destdir = mnist_path,
download = TRUE,
url = "https://github.com/zalandoresearch/fashion-mnist/raw/master/data/fashion/" ,
keep.files = TRUE
)
# clear folder data (avoid wrong zipping)
list_files = list.files(path=mnist_path)
for (x in 1:length(list_files)){
file_path = file.path(mnist_path, list_files[x])
if (substring(file_path, nchar(file_path)-2, nchar(file_path)) == '.gz'){
R.utils::gunzip(file_path, overwrite=TRUE, remove=FALSE)
}
}
}
#getting the path to save
curr_dir = getwd()
path = '../../../data/fasion_mnist/mnist/raw/'
mnist_path = file.path(curr_dir, path)
print(mnist_path)
if (!file.exists(file.path(mnist_path, "train-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "train-labels-idx1-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-labels-idx1-ubyte"))
){
# getting the data
mnist <- read_mnist(
path = NULL,
destdir = mnist_path,
download = TRUE,
url = "https://github.com/zalandoresearch/fashion-mnist/raw/master/data/fashion/" ,
keep.files = TRUE
)
# clear folder data (avoid wrong zipping)
list_files = list.files(path=mnist_path)
for (x in 1:length(list_files)){
file_path = file.path(mnist_path, list_files[x])
if (substring(file_path, nchar(file_path)-2, nchar(file_path)) == '.gz'){
R.utils::gunzip(file_path, overwrite=TRUE, remove=FALSE)
}
}
}
#getting the path to save
curr_dir = getwd()
path = '../../../data/fasion_mnist/mnist/raw'
mnist_path = file.path(curr_dir, path)
print(mnist_path)
if (!file.exists(file.path(mnist_path, "train-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "train-labels-idx1-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-labels-idx1-ubyte"))
){
# getting the data
mnist <- read_mnist(
path = NULL,
destdir = mnist_path,
download = TRUE,
url = "https://github.com/zalandoresearch/fashion-mnist/raw/master/data/fashion/" ,
keep.files = TRUE
)
# clear folder data (avoid wrong zipping)
list_files = list.files(path=mnist_path)
for (x in 1:length(list_files)){
file_path = file.path(mnist_path, list_files[x])
if (substring(file_path, nchar(file_path)-2, nchar(file_path)) == '.gz'){
R.utils::gunzip(file_path, overwrite=TRUE, remove=FALSE)
}
}
}
#getting the path to save
curr_dir = getwd()
path = '../../../data/fashion_mnist/mnist/raw'
mnist_path = file.path(curr_dir, path)
print(mnist_path)
if (!file.exists(file.path(mnist_path, "train-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "train-labels-idx1-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-labels-idx1-ubyte"))
){
# getting the data
mnist <- read_mnist(
path = NULL,
destdir = mnist_path,
download = TRUE,
url = "https://github.com/zalandoresearch/fashion-mnist/raw/master/data/fashion/" ,
keep.files = TRUE
)
# clear folder data (avoid wrong zipping)
list_files = list.files(path=mnist_path)
for (x in 1:length(list_files)){
file_path = file.path(mnist_path, list_files[x])
if (substring(file_path, nchar(file_path)-2, nchar(file_path)) == '.gz'){
R.utils::gunzip(file_path, overwrite=TRUE, remove=FALSE)
}
}
}
knitr::opts_chunk$set(cache = TRUE, echo=TRUE, eval = TRUE)
#getting the path to save
curr_dir = getwd()
path = '../../../data/mnist/raw/'
mnist_path = file.path(curr_dir, path)
print(mnist_path)
if (!file.exists(file.path(mnist_path, "train-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "train-labels-idx1-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-labels-idx1-ubyte"))
){
# getting the data
mnist <- read_mnist(
path = NULL,
destdir = mnist_path,
download = TRUE,
url = "https://www2.harvardx.harvard.edu/courses/IDS_08_v2_03/",
keep.files = TRUE
)
# clear folder data (avoid wrong zipping)
list_files = list.files(path=mnist_path)
for (x in 1:length(list_files)){
file_path = file.path(mnist_path, list_files[x])
if (substring(file_path, nchar(file_path)-2, nchar(file_path)) == '.gz'){
R.utils::gunzip(file_path, overwrite=TRUE, remove=FALSE)
}
}
}
#getting the path to save
curr_dir = getwd()
path = '../../../data/fashion_mnist/mnist/raw'
mnist_path = file.path(curr_dir, path)
print(mnist_path)
if (!file.exists(file.path(mnist_path, "train-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "train-labels-idx1-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-labels-idx1-ubyte"))
){
#   # getting the data
#   mnist <- read_mnist(
#     path = NULL,
#     destdir = mnist_path,
#     download = TRUE,
#     url = "https://github.com/zalandoresearch/fashion-mnist/raw/master/data/fashion/" ,
#     keep.files = TRUE
#   )
#
#   # clear folder data (avoid wrong zipping)
#   list_files = list.files(path=mnist_path)
#   for (x in 1:length(list_files)){
#     file_path = file.path(mnist_path, list_files[x])
#     if (substring(file_path, nchar(file_path)-2, nchar(file_path)) == '.gz'){
#       R.utils::gunzip(file_path, overwrite=TRUE, remove=FALSE)
#     }
#     }
# }
#getting the path to save
curr_dir = getwd()
path = '../../../data/fashion_mnist/mnist/raw'
mnist_path = file.path(curr_dir, path)
print(mnist_path)
if (!file.exists(file.path(mnist_path, "train-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "train-labels-idx1-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-labels-idx1-ubyte"))
){
#   # getting the data
#   mnist <- read_mnist(
#     path = NULL,
#     destdir = mnist_path,
#     download = TRUE,
#     url = "https://github.com/zalandoresearch/fashion-mnist/raw/master/data/fashion/" ,
#     keep.files = TRUE
#   )
#
#   # clear folder data (avoid wrong zipping)
#   list_files = list.files(path=mnist_path)
#   for (x in 1:length(list_files)){
#     file_path = file.path(mnist_path, list_files[x])
#     if (substring(file_path, nchar(file_path)-2, nchar(file_path)) == '.gz'){
#       R.utils::gunzip(file_path, overwrite=TRUE, remove=FALSE)
#     }
#     }
}
#getting the path to save
curr_dir = getwd()
path = '../../../data/fashion_mnist/mnist/raw'
mnist_path = file.path(curr_dir, path)
print(mnist_path)
if (!file.exists(file.path(mnist_path, "train-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "train-labels-idx1-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-labels-idx1-ubyte"))
){
# getting the data
mnist <- read_mnist(
path = NULL,
destdir = mnist_path,
download = TRUE,
url = "https://github.com/zalandoresearch/fashion-mnist/raw/master/data/fashion/" ,
keep.files = TRUE
)
#
#   # clear folder data (avoid wrong zipping)
#   list_files = list.files(path=mnist_path)
#   for (x in 1:length(list_files)){
#     file_path = file.path(mnist_path, list_files[x])
#     if (substring(file_path, nchar(file_path)-2, nchar(file_path)) == '.gz'){
#       R.utils::gunzip(file_path, overwrite=TRUE, remove=FALSE)
#     }
#     }
}
#getting the path to save
curr_dir = getwd()
path = '../../../data/fashion_mnist/mnist/raw'
mnist_path = file.path(curr_dir, path)
print(mnist_path)
if (!file.exists(file.path(mnist_path, "train-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "train-labels-idx1-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-labels-idx1-ubyte"))
){
# getting the data
mnist <- read_mnist(
path = NULL,
destdir = mnist_path,
download = TRUE,
url = "https://github.com/zalandoresearch/fashion-mnist/raw/master/data/fashion/" ,
keep.files = TRUE
)
#
#   # clear folder data (avoid wrong zipping)
#   list_files = list.files(path=mnist_path)
#   for (x in 1:length(list_files)){
#     file_path = file.path(mnist_path, list_files[x])
#     if (substring(file_path, nchar(file_path)-2, nchar(file_path)) == '.gz'){
#       R.utils::gunzip(file_path, overwrite=TRUE, remove=FALSE)
#     }
#     }
}
#getting the path to save
curr_dir = getwd()
path = '../../../data/fashion_mnist/mnist/raw'
mnist_path = file.path(curr_dir, path)
print(mnist_path)
# if (!file.exists(file.path(mnist_path, "train-images-idx3-ubyte")) |
#   !file.exists(file.path(mnist_path, "t10k-images-idx3-ubyte")) |
#   !file.exists(file.path(mnist_path, "train-labels-idx1-ubyte")) |
#   !file.exists(file.path(mnist_path, "t10k-labels-idx1-ubyte"))
#   ){
#
#   # getting the data
#   mnist <- read_mnist(
#     path = NULL,
#     destdir = mnist_path,
#     download = TRUE,
#     url = "https://github.com/zalandoresearch/fashion-mnist/raw/master/data/fashion/" ,
#     keep.files = TRUE
#   )
#
#   # clear folder data (avoid wrong zipping)
list_files = list.files(path=mnist_path)
for (x in 1:length(list_files)){
file_path = file.path(mnist_path, list_files[x])
if (substring(file_path, nchar(file_path)-2, nchar(file_path)) == '.gz'){
R.utils::gunzip(file_path, overwrite=TRUE, remove=FALSE)
}
}
!file.exists(file.path(mnist_path, "train-images-idx3-ubyte"))
file.exists(file.path(mnist_path, "train-images-idx3-ubyte"))
#getting the path to save
curr_dir = getwd()
path = '../../../data/fashion_mnist/mnist/raw'
mnist_path = file.path(curr_dir, path)
print(mnist_path)
file.exists(file.path(mnist_path, "train-images-idx3-ubyte"))
# if (!file.exists(file.path(mnist_path, "train-images-idx3-ubyte")) |
#   !file.exists(file.path(mnist_path, "t10k-images-idx3-ubyte")) |
#   !file.exists(file.path(mnist_path, "train-labels-idx1-ubyte")) |
#   !file.exists(file.path(mnist_path, "t10k-labels-idx1-ubyte"))
#   ){
#
#   # getting the data
#   mnist <- read_mnist(
#     path = NULL,
#     destdir = mnist_path,
#     download = TRUE,
#     url = "https://github.com/zalandoresearch/fashion-mnist/raw/master/data/fashion/" ,
#     keep.files = TRUE
#   )
#
#   # clear folder data (avoid wrong zipping)
list_files = list.files(path=mnist_path)
print(list_files)
for (x in 1:length(list_files)){
file_path = file.path(mnist_path, list_files[x])
if (substring(file_path, nchar(file_path)-2, nchar(file_path)) == '.gz'){
R.utils::gunzip(file_path, overwrite=TRUE, remove=FALSE)
}
}
print(mnist_path)
#   # getting the data
#   mnist <- read_mnist(
#     path = NULL,
#     destdir = mnist_path,
#     download = TRUE,
#     url = "https://github.com/zalandoresearch/fashion-mnist/raw/master/data/fashion/" ,
#     keep.files = TRUE
#   )
#
#   # clear folder data (avoid wrong zipping)
list_files = list.files(path=mnist_path)
print(mnist_path)
#getting the path to save
curr_dir = getwd()
path = '../../../data/fashion_mnist/raw'
mnist_path = file.path(curr_dir, path)
print(mnist_path)
file.exists(file.path(mnist_path, "train-images-idx3-ubyte"))
# if (!file.exists(file.path(mnist_path, "train-images-idx3-ubyte")) |
#   !file.exists(file.path(mnist_path, "t10k-images-idx3-ubyte")) |
#   !file.exists(file.path(mnist_path, "train-labels-idx1-ubyte")) |
#   !file.exists(file.path(mnist_path, "t10k-labels-idx1-ubyte"))
#   ){
#
#   # getting the data
#   mnist <- read_mnist(
#     path = NULL,
#     destdir = mnist_path,
#     download = TRUE,
#     url = "https://github.com/zalandoresearch/fashion-mnist/raw/master/data/fashion/" ,
#     keep.files = TRUE
#   )
#
#   # clear folder data (avoid wrong zipping)
list_files = list.files(path=mnist_path)
print(mnist_path)
for (x in 1:length(list_files)){
file_path = file.path(mnist_path, list_files[x])
if (substring(file_path, nchar(file_path)-2, nchar(file_path)) == '.gz'){
R.utils::gunzip(file_path, overwrite=TRUE, remove=FALSE)
}
}
# }
#getting the path to save
curr_dir = getwd()
path = '../../../data/fashion_mnist/raw'
mnist_path = file.path(curr_dir, path)
print(mnist_path)
file.exists(file.path(mnist_path, "train-images-idx3-ubyte"))
if (!file.exists(file.path(mnist_path, "train-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-images-idx3-ubyte")) |
!file.exists(file.path(mnist_path, "train-labels-idx1-ubyte")) |
!file.exists(file.path(mnist_path, "t10k-labels-idx1-ubyte"))
){
# getting the data
mnist <- read_mnist(
path = NULL,
destdir = mnist_path,
download = TRUE,
url = "https://github.com/zalandoresearch/fashion-mnist/raw/master/data/fashion/" ,
keep.files = TRUE
)
#
#   # clear folder data (avoid wrong zipping)
list_files = list.files(path=mnist_path)
print(mnist_path)
for (x in 1:length(list_files)){
file_path = file.path(mnist_path, list_files[x])
if (substring(file_path, nchar(file_path)-2, nchar(file_path)) == '.gz'){
R.utils::gunzip(file_path, overwrite=TRUE, remove=FALSE)
}
}
# }
#getting the path to save
curr_dir = getwd()
path = '../../../data/fashion_mnist/raw'
mnist_path = file.path(curr_dir, path)
print(mnist_path)
file.exists(file.path(mnist_path, "train-images-idx3-ubyte"))
# if (!file.exists(file.path(mnist_path, "train-images-idx3-ubyte")) |
#   !file.exists(file.path(mnist_path, "t10k-images-idx3-ubyte")) |
#   !file.exists(file.path(mnist_path, "train-labels-idx1-ubyte")) |
#   !file.exists(file.path(mnist_path, "t10k-labels-idx1-ubyte"))
#   ){
#
#   # getting the data
#   mnist <- read_mnist(
#     path = NULL,
#     destdir = mnist_path,
#     download = TRUE,
#     url = "https://github.com/zalandoresearch/fashion-mnist/raw/master/data/fashion/" ,
#     keep.files = TRUE
#   )
#
#   # clear folder data (avoid wrong zipping)
list_files = list.files(path=mnist_path)
print(mnist_path)
for (x in 1:length(list_files)){
file_path = file.path(mnist_path, list_files[x])
if (substring(file_path, nchar(file_path)-2, nchar(file_path)) == '.gz'){
R.utils::gunzip(file_path, overwrite=TRUE, remove=FALSE)
}
}
# }
# load image files
load_image_file = function(filename) {
ret = list()
f = file(filename, 'rb')
readBin(f, 'integer', n = 1, size = 4, endian = 'big')
n    = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
nrow = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
ncol = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
x = readBin(f, 'integer', n = n * nrow * ncol, size = 1, signed = FALSE)
close(f)
data.frame(matrix(x, ncol = nrow * ncol, byrow = TRUE))
}
# load label files
load_label_file = function(filename) {
f = file(filename, 'rb')
readBin(f, 'integer', n = 1, size = 4, endian = 'big')
n = readBin(f, 'integer', n = 1, size = 4, endian = 'big')
y = readBin(f, 'integer', n = n, size = 1, signed = FALSE)
close(f)
y
}
# load images
processing_mnist_data <- function (){
train = load_image_file(file.path(mnist_path, "train-images-idx3-ubyte"))
test  = load_image_file(file.path(mnist_path,"t10k-images-idx3-ubyte"))
train$label =  as.factor(load_label_file(file.path(mnist_path,"train-labels-idx1-ubyte")))
test$label = as.factor(load_label_file(file.path(mnist_path,"t10k-labels-idx1-ubyte")))
result = list('train'=train, 'test'=test)
return(result)
}
processed_data = processing_mnist_data()
train = processed_data$train
test = processed_data$test
X.train = train[, -785]
X.test = test[, -785]
y.train = train[, 785, drop=F]
y.test = test[, 785, drop=F]
dim(train)
dim(test)
dim(y_train)
dim(y.rain)
dim(y.train)
get_image_position_spatial_to_flatten<- function(delImgPosWidth, delImgPosHeight){
# delImgPosHeight: row
# delImgPosWeight : col
tmp = c(1:784)
im <- matrix(unlist(tmp),nrow = 28,byrow = T)
idxs = im[delImgPosHeight, delImgPosWidth]
return(matrix(idxs,nrow = 1,byrow = T)[, ])
}
image_edge_deleting <- function(
data,
delete_type, #by_percent, by_pixel_number
percents_of_data,
image_width,
image_height,
width_del_percent=0,
height_del_percent=0,
from_pixel_width=None,
from_pixel_height=None
){
if (delete_type =='by_percent'){
n = dim(data)[2]
from_pixel_width = ceiling((1-width_del_percent)*image_width)
from_pixel_height = ceiling((1-height_del_percent)*image_height)
}
if (delete_type=='by_pixel_number'){
from_pixel_width = from_pixel_width
from_pixel_height = from_pixel_height
}
flatten_columns_removed = get_image_position_spatial_to_flatten(
from_pixel_width:image_width,
from_pixel_height: image_height
)
flatten_rows_removed = sample.int(nrow(data), as.integer(nrow(data)*percents_of_data))
missing_data = data
missing_data[flatten_rows_removed, flatten_columns_removed] <- NA
result = list(
'missing_data'=missing_data,
'flatten_columns_removed'=flatten_columns_removed,
'flatten_rows_removed'=flatten_rows_removed
)
return(result)
}
# visualize the deleted images
visualize_digit <- function(missing_X, y, train_removed_rows, per_col, per_row, title){
par(mfcol=c(per_col, per_row))
par(mar=c(0, 0, 3, 0), xaxs='i', yaxs='i')
for (idx in 1:(per_col*per_row)) {
im <- matrix(unlist(missing_X[train_removed_rows, ][idx, ]),nrow = 28,byrow = T)
im <- t(apply(im, 2, rev))
image(1:28, 1:28, im,  xaxt='n', main=paste(y[train_removed_rows,,drop=F][idx, ]))
#image(1:28, 1:28, im, col=gray((0:255)/255), xaxt='n', main=paste(y[train_removed_rows,,drop=F][idx, ]))
}
}
sampling_data <- function(data, y_col_name, sample_perc){
data$label= data[, y_col_name]
sample_indices <- sample.split(Y=data[, 'label'], SplitRatio = sample_perc)
sample_data <- as.data.frame(subset(data, sample_indices == TRUE))
result = list(
'sample'=sample_data,
'X'=as.matrix(sample_data[, 1:(28*28)]),
'y'=sample_data[,'label', drop=F]
)
return(result)
}
require(knitr)
FILE_NAME = 'v13'
purl("imputation_fashion_mnist.Rmd", output = 'imputation_fashion_mnist.R')
purl("imputation.Rmd", output = 'imputation.R')
